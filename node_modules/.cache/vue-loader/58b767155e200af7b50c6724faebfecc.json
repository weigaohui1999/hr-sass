{"remainingRequest":"E:\\text\\vue基础\\vue-admin-template-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\text\\vue基础\\vue-admin-template-master\\src\\views\\setting\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\text\\vue基础\\vue-admin-template-master\\src\\views\\setting\\index.vue","mtime":1661568858918},{"path":"E:\\text\\vue基础\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1661324308788},{"path":"E:\\text\\vue基础\\vue-admin-template-master\\node_modules\\babel-loader\\lib\\index.js","mtime":1661324301563},{"path":"E:\\text\\vue基础\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1661324308788},{"path":"E:\\text\\vue基础\\vue-admin-template-master\\node_modules\\vue-loader\\lib\\index.js","mtime":1661324302450}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGFkZFJvbGUsIGRlbGV0ZVJvbGUsIGdldENvbXBhbnlJbmZvLCBnZXRSb2xlRGV0YWlsLCBnZXRSb2xlTGlzdCwgdXBkYXRlUm9sZSB9IGZyb20gJ0AvYXBpL3NldHRpbmcnCmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JwoKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEgKCkgewogICAgcmV0dXJuIHsKICAgICAgbGlzdDogW10sCiAgICAgIHBhZ2U6IHsKICAgICAgICAvLyDmlL7nva7pobXnoIHlj4rnm7jlhbPmlbDmja4KICAgICAgICBwYWdlOiAxLAogICAgICAgIHBhZ2VzaXplOiAxMCwKICAgICAgICB0b3RhbDogMCAvLyDorrDlvZXmgLvmlbAKICAgICAgfSwKICAgICAgZnJvbURhdGU6IHt9LAogICAgICBzaG93RGlhbG9nOiBmYWxzZSwKICAgICAgLy8g5LiT6Zeo5o6l5pS25paw5aKe5oiW6ICF57yW6L6R55qE57yW6L6R55qE6KGo5Y2V5pWw5o2uCiAgICAgIHJvbGVGb3JtOiB7fSwKICAgICAgcnVsZXM6IHsKICAgICAgICBuYW1lOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+inkuiJsuWQjeensOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdibHVyJyB9XQogICAgICB9LAogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0Um9sZUxpc3QoKQogICAgdGhpcy5nZXRDb21wYW55SW5mbygpCiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwR2V0dGVycyhbJ2NvbXBhbnlJZCddKQogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgZ2V0Um9sZUxpc3QoKSB7CiAgICAgIGNvbnN0IHt0b3RhbCAscm93c30gPSBhd2FpdCBnZXRSb2xlTGlzdCh0aGlzLnBhZ2UpCiAgICAgIHRoaXMucGFnZS50b3RhbCA9IHRvdGFsCiAgICAgIHRoaXMubGlzdCA9IHJvd3MKICAgIH0sCiAgICBhc3luYyBnZXRDb21wYW55SW5mbygpIHsKICAgICAgdGhpcy5mcm9tRGF0ZSA9IGF3YWl0IGdldENvbXBhbnlJbmZvKHRoaXMuY29tcGFueUlkKQogICAgfSwKICAgIGFzeW5jIGRlbChpZCkgewogICAgICBhd2FpdCB0aGlzLiRjb25maXJtKCfnoa7lrpropoHliKDpmaTmlLnop5LoibLlkJfvvJ8nKS50aGVuKCgpID0+IHsKICAgICAgICBkZWxldGVSb2xlKGlkKQogICAgICAgIHRoaXMuZ2V0Um9sZUxpc3QoKSAvLyDph43mlrDliqDovb3mlbDmja4KICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+WIoOmZpOinkuiJsuaIkOWKnycpCiAgICAgIH0pLmNhdGNoKCkKICAgIH0sCiAgICBjaGFuZ2VQYWdlKG5ld1BhZ2UpIHsKICAgICAgdGhpcy5wYWdlLnBhZ2UgPSBuZXdQYWdlCiAgICAgIHRoaXMuZ2V0Um9sZUxpc3QoKQogICAgfSwKICAgIGFzeW5jIGVkaXRSb2xlKGlkKSB7CiAgICAgIHRoaXMucm9sZUZvcm0gPSBhd2FpdCBnZXRSb2xlRGV0YWlsKGlkKQogICAgICB0aGlzLnNob3dEaWFsb2cgPSB0cnVlCiAgICB9LAogICAgYnRuQ2FuY2VsKCkgewogICAgICB0aGlzLiRyZWZzLnJvbGVGb3JtLnJlc2V0RmllbGRzKCkKICAgICAgdGhpcy5zaG93RGlhbG9nID0gZmFsc2UKICAgIH0sCiAgICBhc3luYyBidG5PSygpIHsKICAgICAgYXdhaXQgdGhpcy4kcmVmcy5yb2xlRm9ybS52YWxpZGF0ZShhc3luYyh2YWlkKSA9PiB7CiAgICAgICAgaWYgKHZhaWQpIHsKICAgICAgICAgIGlmICh0aGlzLnJvbGVGb3JtLmlkKSB7CiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZVJvbGUodGhpcy5yb2xlRm9ybSkKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGF3YWl0IGFkZFJvbGUodGhpcy5yb2xlRm9ybSkKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuZ2V0Um9sZUxpc3QoKQogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfmk43kvZzmiJDlip8nKQogICAgICAgICAgdGhpcy5idG5DYW5jZWwoKQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICBhc3luYyBhZGRSb2xlKCkgewogICAgICB0aGlzLnNob3dEaWFsb2cgPSB0cnVlCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6EA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/setting","sourcesContent":["<template>\n  <div class=\"setting-container\">\n    <div class=\"app-container\">\n      <el-card>\n        <el-tabs>\n          <el-tab-pane label=\"角色管理\">\n            <el-row>\n              <el-button icon=\"el-icon-plus\" type=\"primary\" size=\"small\" @click=\"addRole\">新增角色</el-button>\n            </el-row>\n            <el-table border=\"\" :data=\"list\">\n              <el-table-column label=\"序号\" align=\"center\" type=\"index\" width=\"120\"></el-table-column>\n              <el-table-column label=\"名称\" align=\"center\" prop=\"name\" width=\"120\"></el-table-column>\n              <el-table-column label=\"描述\" align=\"center\" prop=\"description\"></el-table-column>\n              <el-table-column label=\"操作\">\n                <template slot-scope=\"{ row }\">\n                  <el-button type=\"success\" size=\"small\">分配角色</el-button>\n                  <el-button type=\"primary\" size=\"small\" @click=\"editRole(row.id)\">编辑</el-button>\n                  <el-button type=\"danger\" size=\"small\" @click=\"del(row.id)\">删除</el-button>\n                </template>\n              </el-table-column>\n            </el-table>\n            <el-row type=\"flex\" justify=\"center\" align=\"middle\" style=\"height: 60px\">\n              <el-pagination\n                  layout=\"prev,pager,next\"\n                  :page-size=\"page.pagesize\"\n                  :current-page=\"page.page\"\n                  :total=\"page.total\"\n                  @current-change=\"changePage\"\n              ></el-pagination>\n            </el-row>\n          </el-tab-pane>\n          <el-tab-pane label=\"公司管理\">\n            <el-alert\n                title=\"对公司名称、公司地址、营业执照、公司地区的更新，将使得公司资料被重新审核，请谨慎修改\"\n                type=\"info\"\n                show-icon\n                :closable=\"false\"\n            />\n            <el-form label-width=\"120px\" style=\"margin-top:50px\">\n              <el-form-item label=\"公司名称\">\n                <el-input v-model=\"fromDate.name\" disabled style=\"width:400px\" />\n              </el-form-item>\n              <el-form-item label=\"公司地址\">\n                <el-input v-model=\"fromDate.companyAddress\" disabled style=\"width:400px\" />\n              </el-form-item>\n              <el-form-item label=\"邮箱\">\n                <el-input v-model=\"fromDate.mailbox\" disabled style=\"width:400px\" />\n              </el-form-item>\n              <el-form-item label=\"备注\">\n                <el-input v-model=\"fromDate.remarks\" type=\"textarea\" :rows=\"3\" disabled style=\"width:400px\" />\n              </el-form-item>\n            </el-form>\n          </el-tab-pane>\n        </el-tabs>\n      </el-card>\n    </div>\n    <el-dialog title=\"编辑弹层\" :visible=\"showDialog\" @close=\"btnCancel\">\n      <el-form ref=\"roleForm\" :model=\"roleForm\" :rules=\"rules\" label-width=\"120px\">\n        <el-form-item label=\"角色名称\" prop=\"name\">\n          <el-input v-model=\"roleForm.name\" />\n        </el-form-item>\n        <el-form-item label=\"角色描述\">\n          <el-input v-model=\"roleForm.description\" />\n        </el-form-item>\n      </el-form>\n      <!-- 底部 -->\n      <el-row slot=\"footer\" type=\"flex\" justify=\"center\">\n        <el-col :span=\"6\">\n          <el-button size=\"small\" @click=\"btnCancel\">取消</el-button>\n          <el-button size=\"small\" type=\"primary\" @click=\"btnOK\">确定</el-button>\n        </el-col>\n      </el-row>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { addRole, deleteRole, getCompanyInfo, getRoleDetail, getRoleList, updateRole } from '@/api/setting'\nimport { mapGetters } from 'vuex'\n\nexport default {\n  data () {\n    return {\n      list: [],\n      page: {\n        // 放置页码及相关数据\n        page: 1,\n        pagesize: 10,\n        total: 0 // 记录总数\n      },\n      fromDate: {},\n      showDialog: false,\n      // 专门接收新增或者编辑的编辑的表单数据\n      roleForm: {},\n      rules: {\n        name: [{ required: true, message: '角色名称不能为空', trigger: 'blur' }]\n      },\n    }\n  },\n  created() {\n    this.getRoleList()\n    this.getCompanyInfo()\n  },\n  computed: {\n    ...mapGetters(['companyId'])\n  },\n  methods: {\n    async getRoleList() {\n      const {total ,rows} = await getRoleList(this.page)\n      this.page.total = total\n      this.list = rows\n    },\n    async getCompanyInfo() {\n      this.fromDate = await getCompanyInfo(this.companyId)\n    },\n    async del(id) {\n      await this.$confirm('确定要删除改角色吗？').then(() => {\n        deleteRole(id)\n        this.getRoleList() // 重新加载数据\n        this.$message.success('删除角色成功')\n      }).catch()\n    },\n    changePage(newPage) {\n      this.page.page = newPage\n      this.getRoleList()\n    },\n    async editRole(id) {\n      this.roleForm = await getRoleDetail(id)\n      this.showDialog = true\n    },\n    btnCancel() {\n      this.$refs.roleForm.resetFields()\n      this.showDialog = false\n    },\n    async btnOK() {\n      await this.$refs.roleForm.validate(async(vaid) => {\n        if (vaid) {\n          if (this.roleForm.id) {\n            await updateRole(this.roleForm)\n          } else {\n            await addRole(this.roleForm)\n          }\n          this.getRoleList()\n          this.$message.success('操作成功')\n          this.btnCancel()\n        }\n      })\n    },\n    async addRole() {\n      this.showDialog = true\n    }\n  }\n}\n</script>\n\n<style>\n\n</style>\n"]}]}
{"remainingRequest":"E:\\text\\vue基础\\vue-admin-template-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\text\\vue基础\\vue-admin-template-master\\src\\views\\employees\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\text\\vue基础\\vue-admin-template-master\\src\\views\\employees\\index.vue","mtime":1661598261982},{"path":"E:\\text\\vue基础\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1661324308788},{"path":"E:\\text\\vue基础\\vue-admin-template-master\\node_modules\\babel-loader\\lib\\index.js","mtime":1661324301563},{"path":"E:\\text\\vue基础\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1661324308788},{"path":"E:\\text\\vue基础\\vue-admin-template-master\\node_modules\\vue-loader\\lib\\index.js","mtime":1661324302450}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGRlbEVtcGxveWVlLCBnZXRFbXBsb3llZUxpc3QgfSBmcm9tICdAL2FwaS9lbXBsb3llZXMnCmltcG9ydCBFbXBsb3llZUVudW0gZnJvbSAnQC9hcGkvY29uc3RhbnQvZW1wbG95ZWVzJwppbXBvcnQgQWRkRW1wbG95ZWUgZnJvbSAnQC92aWV3cy9lbXBsb3llZXMvY29tcG9uZW50cy9hZGQtZW1wbG95ZWUnCmltcG9ydCB7IGZvcm1hdERhdGUgfSBmcm9tICdAL2ZpbHRlcnMnCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7IEFkZEVtcGxveWVlIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybnsKICAgICAgbGlzdDogW10sCiAgICAgIHBhZ2U6IHsKICAgICAgICBwYWdlOiAxLAogICAgICAgIHNpemU6IDEwLAogICAgICAgIHRvdGFsOiAwCiAgICAgIH0sCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBzaG93RGlhbG9nOiBmYWxzZQogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0RW1wbG95ZWVMaXN0KCkKICB9LAogIG1ldGhvZHM6IHsKICAgIGZvcm1hdEVtcGxveW1lbnQocm93LCBjb2x1bW4sIGNlbGxWYWx1ZSwgaW5kZXgpIHsKICAgICAgY29uc3Qgb2JqID0gRW1wbG95ZWVFbnVtLmhpcmVUeXBlLmZpbmQoaXRlbSA9PiBpdGVtLmlkID09PSBjZWxsVmFsdWUpCiAgICAgIHJldHVybiBvYmogPyBvYmoudmFsdWUgOiAn5pyq55+lJwogICAgfSwKICAgIGFzeW5jIGdldEVtcGxveWVlTGlzdCgpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZQogICAgICBjb25zdCB7IHRvdGFsLHJvd3MgfSA9IGF3YWl0IGdldEVtcGxveWVlTGlzdCh0aGlzLnBhZ2UpCiAgICAgIHRoaXMucGFnZS50b3RhbCA9IHRvdGFsCiAgICAgIHRoaXMubGlzdCA9IHJvd3MKICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgIH0sCiAgICBjaGFuZ2VQYWdlKG5ld1BhZ2UpIHsKICAgICAgdGhpcy5wYWdlLnBhZ2UgPSBuZXdQYWdlCiAgICAgIHRoaXMuZ2V0RW1wbG95ZWVMaXN0KCkKICAgIH0sCiAgICBhc3luYyBkZWxFbXBsb3llZShpZCkgewogICAgICBhd2FpdCBkZWxFbXBsb3llZShpZCkudGhlbigoKT0+ewogICAgICAgIHRoaXMuZ2V0RW1wbG95ZWVMaXN0KCkKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+WIoOmZpOWRmOW3peaIkOWKnycpCiAgICAgIH0pLmNhdGNoKChlcnIpPT57CiAgICAgICAgY29uc29sZS5sb2coZXJyKQogICAgICB9KQogICAgfSwKICAgIGV4cG9ydERhdGEoKSB7CiAgICAgIGNvbnN0IGhlYWRlcnMgPSB7CiAgICAgICAgJ+aJi+acuuWPtyc6ICdtb2JpbGUnLAogICAgICAgICflp5PlkI0nOiAndXNlcm5hbWUnLAogICAgICAgICflhaXogYzml6XmnJ8nOiAndGltZU9mRW50cnknLAogICAgICAgICfogZjnlKjlvaLlvI8nOiAnZm9ybU9mRW1wbG95bWVudCcsCiAgICAgICAgJ+i9rOato+aXpeacnyc6ICdjb3JyZWN0aW9uVGltZScsCiAgICAgICAgJ+W3peWPtyc6ICd3b3JrTnVtYmVyJywKICAgICAgICAn6YOo6ZeoJzogJ2RlcGFydG1lbnROYW1lJwogICAgICB9CiAgICAgIGltcG9ydCgnQC92ZW5kb3IvRXhwb3J0MkV4Y2VsJykudGhlbihhc3luYyBleGNlbCA9PnsKICAgICAgICBjb25zdCB7IHJvd3MgfSA9IGF3YWl0IGdldEVtcGxveWVlTGlzdCh7IHBhZ2U6IDEsIHNpemU6IHRoaXMucGFnZS50b3RhbCB9KQogICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmZvcm1hdEpzb24oaGVhZGVycywgcm93cykKICAgICAgICBleGNlbC5leHBvcnRfanNvbl90b19leGNlbCh7CiAgICAgICAgICBoZWFkZXI6IE9iamVjdC5rZXlzKGhlYWRlcnMpLAogICAgICAgICAgZGF0YTogZGF0YSwKICAgICAgICAgIGZpbGVuYW1lOiAn5ZGY5bel5bel6LWE6KGoJwogICAgICAgIH0pCiAgICAgIH0pCiAgICB9LAogICAgLy8g5bCGW3t9XSAs6L2s5Li6W1tdXQogICAgZm9ybWF0SnNvbihoZWFkZXJzLCByb3dzKSB7CiAgICAgIHJldHVybiByb3dzLm1hcChpdGVtID0+IHsKICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoaGVhZGVycykubWFwKAogICAgICAgICAga2V5ID0+IHsKICAgICAgICAgICAgaWYoaGVhZGVyc1trZXldID09PSd0aW1lT2ZFbnRyeScgfHwgaGVhZGVyc1trZXldID09PSdjb3JyZWN0aW9uVGltZScpIHsKICAgICAgICAgICAgICByZXR1cm4gZm9ybWF0RGF0ZShpdGVtW2hlYWRlcnNba2V5XV0pCiAgICAgICAgICAgIH0gZWxzZSBpZihoZWFkZXJzW2tleV0gPT09J2Zvcm1PZkVtcGxveW1lbnQnKSB7CiAgICAgICAgICAgICAgY29uc3Qgb2JqID0gRW1wbG95ZWVFbnVtLmhpcmVUeXBlLmZvckVhY2goaXRlbXMgPT4gaXRlbXMuaWQgPSBpdGVtW2hlYWRlcnNba2V5XV0pCiAgICAgICAgICAgICAgcmV0dXJuIG9iaiA/IG9iai52YWx1ZSA6ICfmnKrnn6UnCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGl0ZW1baGVhZGVyc1trZXldXQogICAgICAgICAgfQogICAgICAgICkKICAgICAgfSkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/employees","sourcesContent":["<template>\n  <div class=\"employees-container\">\n    <div class=\"app-container\">\n      <page-tools :show-before=\"true\">\n        <span slot=\"before\">\n          共{{ page.total }}多少条记录\n        </span>\n        <template v-slot:after>\n          <el-button size=\"small\" type=\"warning\" @click=\"$router.push('/import?type=user')\">导入</el-button>\n          <el-button size=\"small\" type=\"danger\" @click=\"exportData\">导出</el-button>\n          <el-button size=\"small\" type=\"primary\" @click=\"showDialog = true\">新增员工</el-button>\n        </template>\n      </page-tools>\n\n      <el-card>\n        <el-table border :data=\"list\" v-loading=\"loading\">\n          <el-table-column label=\"序号\" sortable=\"\" type=\"index\" />\n          <el-table-column label=\"姓名\" sortable=\"\" prop=\"username\"/>\n          <el-table-column label=\"工号\" sortable=\"\" prop=\"workNumber\"/>\n          <el-table-column label=\"聘用形式\" sortable=\"\" prop=\"formOfEmployment\" :formatter=\"formatEmployment\"/>\n          <el-table-column label=\"部门\" sortable=\"\" prop=\"departmentName\"/>\n          <el-table-column label=\"入职时间\" sortable=\"\" prop=\"timeOfEntry\">\n            <template slot-scope=\"{ row }\">\n              {{ row.timeOfEntry | formatDate }}\n            </template>\n          </el-table-column>\n          <el-table-column label=\"账户状态\" sortable=\"\" prop=\"enableState\">\n            <template slot-scope=\"{ row }\">\n              <el-switch :value=\"row.enableState === 1\" />\n            </template>\n          </el-table-column>\n          <el-table-column label=\"操作\" sortable=\"\" fixed=\"right\" width=\"280\">\n            <template slot-scope=\"{ row }\">\n              <el-button type=\"text\" size=\"small\">查看</el-button>\n              <el-button type=\"text\" size=\"small\">转正</el-button>\n              <el-button type=\"text\" size=\"small\">调岗</el-button>\n              <el-button type=\"text\" size=\"small\">离职</el-button>\n              <el-button type=\"text\" size=\"small\">角色</el-button>\n              <el-button type=\"text\" size=\"small\" @click=\"delEmployee(row.id)\">删除</el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n        <!-- 分页组件 -->\n        <el-row type=\"flex\" justify=\"center\" align=\"middle\" style=\"height: 60px\">\n          <el-pagination layout=\"prev, pager, next\" :current-page=\"page.page\" :page-size=\"page.size\" :total=\"page.total\" @current-change=\"changePage\"/>\n        </el-row>\n      </el-card>\n    </div>\n    <add-employee :show-dialog.sync=\"showDialog\"/>\n  </div>\n</template>\n\n<script>\nimport { delEmployee, getEmployeeList } from '@/api/employees'\nimport EmployeeEnum from '@/api/constant/employees'\nimport AddEmployee from '@/views/employees/components/add-employee'\nimport { formatDate } from '@/filters'\nexport default {\n  components: { AddEmployee },\n  data() {\n    return{\n      list: [],\n      page: {\n        page: 1,\n        size: 10,\n        total: 0\n      },\n      loading: false,\n      showDialog: false\n    }\n  },\n  created() {\n    this.getEmployeeList()\n  },\n  methods: {\n    formatEmployment(row, column, cellValue, index) {\n      const obj = EmployeeEnum.hireType.find(item => item.id === cellValue)\n      return obj ? obj.value : '未知'\n    },\n    async getEmployeeList() {\n      this.loading = true\n      const { total,rows } = await getEmployeeList(this.page)\n      this.page.total = total\n      this.list = rows\n      this.loading = false\n    },\n    changePage(newPage) {\n      this.page.page = newPage\n      this.getEmployeeList()\n    },\n    async delEmployee(id) {\n      await delEmployee(id).then(()=>{\n        this.getEmployeeList()\n        this.$message.success('删除员工成功')\n      }).catch((err)=>{\n        console.log(err)\n      })\n    },\n    exportData() {\n      const headers = {\n        '手机号': 'mobile',\n        '姓名': 'username',\n        '入职日期': 'timeOfEntry',\n        '聘用形式': 'formOfEmployment',\n        '转正日期': 'correctionTime',\n        '工号': 'workNumber',\n        '部门': 'departmentName'\n      }\n      import('@/vendor/Export2Excel').then(async excel =>{\n        const { rows } = await getEmployeeList({ page: 1, size: this.page.total })\n        const data = this.formatJson(headers, rows)\n        excel.export_json_to_excel({\n          header: Object.keys(headers),\n          data: data,\n          filename: '员工工资表'\n        })\n      })\n    },\n    // 将[{}] ,转为[[]]\n    formatJson(headers, rows) {\n      return rows.map(item => {\n        return Object.keys(headers).map(\n          key => {\n            if(headers[key] ==='timeOfEntry' || headers[key] ==='correctionTime') {\n              return formatDate(item[headers[key]])\n            } else if(headers[key] ==='formOfEmployment') {\n              const obj = EmployeeEnum.hireType.forEach(items => items.id = item[headers[key]])\n              return obj ? obj.value : '未知'\n            }\n            return item[headers[key]]\n          }\n        )\n      })\n    }\n  }\n}\n</script>\n\n<style>\n\n</style>\n"]}]}